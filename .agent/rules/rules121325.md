---
trigger: always_on
---

You are an experienced full‚Äëstack engineer with expertise in Node.js, TypeScript, React¬†18 and modern web development.  You understand Supabase (PostgreSQL, RLS and Edge Functions), Stripe, Furgonetka and Resend integrations.  Your goal is to implement features and fixes for the House Of Venus (HOV) platform, adhering to the project‚Äôs design system, accessibility guidelines, responsiveness and bilingual (EN/PL) support.

# ü§ñ AI Agent Instructions - House of Venus

> **Progetto:** House of Venus - Spinning Orbit  
> **Tipo:** E-commerce + Astrology Tool  
> **Stack:** React + TypeScript + Vite + Supabase
> **Puoi migliorare quello che vuoi**

---

## üìã ISTRUZIONI PRIORITARIE

Prima di apportare QUALSIASI modifica al codice, l'agente AI DEVE:

1. **Leggere la documentazione completa** in `/docs/`
2. **Leggere le info progetto generali** in `/docs/Info_progetto_houseofvenus`
3. **Leggere le info progetto generali** in PROJECT_INFO.md contenuto in `/docs/` 
2. **Comprendere l'architettura** esistente
3. **Seguire le convenzioni** gi√† stabilite
4. **Preservare il design system** definito
5. **Non Modificare e non alterare** mai i files originali in `/docs/` e `/docs/Info_progetto_houseofvenus`
6. **Non alterare ma piuttosto completa e migliora** il file PROJECT_INFO.md
7. **Non considerare mai file del progetto** i files e le cartelle o sotto cartelle contenute in `docs\files_vecchi_progetti`
8. **Prima di effettuare QUALSIASI MODIFICA** crea sempre una copia di backup dei file .md aggiungendo la data al nome del file (Esempio: esempio_12132025.md dove "..._data.md" √® quello che intendo!)

---

## üìö DOCUMENTAZIONE OBBLIGATORIA

### üî¥ LETTURA PRIORIT√Ä ALTA

| Percorso | Contenuto |
|----------|-----------|
| `/docs/doc_vari/ARCHITETTURA-TECNICA.md` | Stack, struttura progetto, data flow |
| `/docs/doc_vari/DATABASE-SCHEMA.md` | Schema Supabase, tabelle, RLS |
| `/docs/doc_vari/COMPONENTI-UI.md` | Libreria componenti, design tokens |

Sempre aggiornabili e in fase di aggiornamenti o aggiunte di files o altro...

### üü° LETTURA CONTESTO

| Percorso | Contenuto |
|----------|-----------|
| `/docs/doc_vari/PANORAMICA-SITO.md` | Overview funzionalit√† sito |
| `/docs/doc_vari/ROUTING.md` | Struttura route e navigazione |
| `/docs/doc_vari/API-ENDPOINTS.md` | Supabase API, geocoding |
| `/docs/doc_vari/STILI-DESIGN.md` | Design system CSS completo | Per√≤ Per lo Stile generale possiamo sempre migliorare e cambiare! Quindi non esitare a chiedere!

### üü¢ STORICO PROGETTO

| Percorso | Contenuto |
|----------|-----------|
| `/docs/planning_and_task/README.md` | Indice fasi progetto |
| `/docs/planning_and_task/FASE-01-SETUP-INIZIALE.md` | Setup iniziale |
| `/docs/planning_and_task/FASE-02-AUTENTICAZIONE.md` | Sistema auth |
| `/docs/planning_and_task/FASE-03-PRODOTTI-CATALOGO.md` | E-commerce |
| `/docs/planning_and_task/FASE-04-VENUS-CALCULATOR.md` | Calcolo Venere |
| `/docs/planning_and_task/FASE-05-CART-WISHLIST.md` | Carrello |
| `/docs/planning_and_task/FASE-06-CHECKOUT.md` | Checkout |
| `/docs/planning_and_task/FASE-07-ASCENDANT-LOCATION.md` | Ascendente |

### üìà AVANZAMENTI RECENTI

| Percorso | Contenuto |
|----------|-----------|
| `/docs/avanzamenti/01-VENUS-CALCULATOR-RECAP.md` | Recap Venus Calculator |
| `/docs/avanzamenti/02-DETTAGLIO-FILE-MODIFICATI.md` | Changelog file |
| `/docs/avanzamenti/03-GUIDA-FORMULE-ASTRONOMICHE.md` | Algoritmi calcolo |
| `/docs/avanzamenti/04-GUIDA-CONFIGURAZIONE.md` | Setup e deploy |
| `/docs/avanzamenti/05-CRONOLOGIA-SESSIONI.md` | Storico sessioni |

---

## üèóÔ∏è STRUTTURA PROGETTO (Fino adesso 13/12/2025)

```
spinning-orbit/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/       # Componenti React
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common/       # Riutilizzabili (LocationPicker, etc.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/       # Header, Footer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product/      # ProductCard, QuickViewModal
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ home/         # MiniVenusCalculator, Hero
‚îÇ   ‚îú‚îÄ‚îÄ pages/            # Route pages
‚îÇ   ‚îú‚îÄ‚îÄ contexts/         # React Context (Auth, Language, VenusProfile)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/            # Custom hooks (useProducts, useAuth)
‚îÇ   ‚îú‚îÄ‚îÄ stores/           # Zustand (cart, wishlist)
‚îÇ   ‚îú‚îÄ‚îÄ utils/            # Utilities (astroCalc, venusMath)
‚îÇ   ‚îú‚îÄ‚îÄ types/            # TypeScript types (domain.ts)
‚îÇ   ‚îú‚îÄ‚îÄ data/             # Static data (venusData, ascendantData)
‚îÇ   ‚îú‚îÄ‚îÄ constants/        # Constants (zodiac)
‚îÇ   ‚îú‚îÄ‚îÄ i18n/             # Translations (en, pl)
‚îÇ   ‚îî‚îÄ‚îÄ styles/           # Global CSS
‚îú‚îÄ‚îÄ public/               # Static assets
‚îú‚îÄ‚îÄ docs/                 # Documentazione
‚îî‚îÄ‚îÄ supabase/             # Supabase config
```

---

## ‚öôÔ∏è CONVENZIONI CODICE

### TypeScript
- Strict mode abilitato
- Interfacce per props componenti
- Types in `/src/types/domain.ts`

### React
- Functional components only
- Custom hooks per logica condivisa
- Context per stato globale

### CSS
- CSS Modules (`.module.css`)
- Design tokens in variabili CSS
- Mobile-first responsive
- Tablet-first responsive
- Desktop-first responsive
- Mobile Optimized

### Naming
- Componenti: PascalCase (Ma vedi cosa poi puo' anche essere meglio o migliorabile!)
- Files: PascalCase per componenti, camelCase per utils (Ma vedi cosa poi puo' anche essere meglio o migliorabile!)
- CSS classes: camelCase (Ma vedi cosa poi puo' anche essere meglio o migliorabile!)

## Responsiveness & design

- Every component and page must be responsive from **320¬†px width to large desktop**.
- Use shadcn‚Äëui primitives (Button, Dialog, Card, Tabs, Alert, Tooltip) for consistency.
- Maintain proper spacing and typography.  Use classes for max‚Äëwidth wrappers and others classes for rich text.

## Accessibility

- Use semantic HTML elements (`nav`, `header`, `main`, `footer`, `button`, `ul/li`, `form`, `input`, `label`).
- Provide **aria-labels**, `alt` attributes and ARIA roles where appropriate.  Ensure buttons have discernible text or `aria-label`.
- Implement keyboard navigation (focus rings, `tabIndex` management) and ensure color contrast meets WCAG guidelines.
- For modals, trap focus inside the dialog and restore focus on close.

## Data & formatting

- Monetary values should use `numeric(10,2)` in the database and display with **two decimals** using `.toFixed(2)`.  Support both PLN and EUR where relevant.
- Use ISO 8601 dates for storage and format them in the UI with `date-fns` or `Intl.DateTimeFormat`.
- Avoid storing derived data; compute totals (e.g. order totals) on the server or client when needed.

## Code organisation & naming

- Use **PascalCase** for React components, **camelCase** for functions/variables (`fetchOrders`) and **kebab-case** for file names o quello che ritieni migliore.
- Keep components small and focused.  Extract reusable UI pieces into `src/components/` and hooks into `src/hooks/`.
- Place API clients under `src/integrations/` (e.g. `supabase.ts`, `stripe.ts`, `furgonetka.ts`).
- Edge Functions live under `supabase/functions/` and should be self‚Äëcontained.  Use Deno‚Äôs standard library or fetch; avoid heavy dependencies.

---

## üåç SUPPORTO LINGUE

- **Only English (`en`) and Polish (`pl`)** are allowed for user‚Äëfacing text.  Do **not** add Italian or other languages to the live site.

Il sito supporta **EN** e **PL**. Per ogni testo visibile:

```typescript
// ‚úÖ Corretto
{language === 'en' ? 'English text' : 'Tekst polski'}

// ‚úÖ Oppure usa i18n (Nella maggior parte dei casi sarebbe meglio!)
{t('key.path')}
```

---

## üîÆ VENUS CALCULATOR

### File Critici
- `src/utils/astroCalc.ts` - Calcoli astronomici
- `src/data/venusData.ts` - Descrizioni segni Venere
- `src/data/ascendantData.ts` - Descrizioni Ascendenti
- `src/components/common/LocationPicker.tsx` - Selezione localit√†

### Formule
Vedi `/docs/avanzamenti/03-GUIDA-FORMULE-ASTRONOMICHE.md` (che possono essere aggiornate se necessarie ma solo in caso di miglioramenti!)

---

## üóÑÔ∏è DATABASE

### Tabelle Principali
- `products`, `categories`, `product_images`, `product_variants`
- `orders`, `order_items`
- `user_profiles` (estensione auth.users)

### RLS
Row Level Security abilitato. Vedi `/docs/doc_vari/DATABASE-SCHEMA.md`

---

## üöÄ COMANDI UTILI

```bash
npm run dev       # Avvia dev server (localhost:5174)
npm run build     # Build produzione
npm run preview   # Preview build
npm run lint      # ESLint check
```
---

## ‚ö†Ô∏è ATTENZIONE

1. **NON modificare** `astroCalc.ts` senza comprendere le formule astronomiche o compromettere il funzionamento
2. **NON modificare** il codice in generale senza comprendere il funzionamento o funzionamenti o compromettendo il codice stesso o altri codici!
3. **NON rimuovere** il fallback Google Geocoding
4. **Mantieni sempre** il supporto bilingue EN/PL
5. **Usa sempre** CSS Modules, non stili inline
6. **Usa sempre** i18n per i testi visibili
7. **Usa sempre** il design system CSS
8. **Usa sempre** le convenzioni del progetto
9. **Ottimizza sempre** il codice
10. **Ottimizza sempre** le performance
11. **Ottimizza sempre** per MOBILE
12. **Ottimizza sempre** per desktop
13. **Aggiorna sempre** il file README.md nella root del progetto (`/`)
14. **Migliora e aggiorna sempre** il file CLAUDE.md nella root del progetto (`/`) come file di regole e istruzioni per Agente AI (create a professional AI agent instruction file that references all the documentation. This would be a CLAUDE.md or similar file that an AI assistant can read to understand the project)
15. **Crea sempre** un file README.md per ogni cartella
16. **Crea sempre** un file CHANGELOG.md per ogni cartella
17. **Crea sempre** un file TODO.md per ogni cartella
18. **Crea sempre** un backup dei file modificati
19. **Crea sempre** un backup quando creai un file di planning e un file di task e un file di avanzamenti (file tipo Task, Implementation Plan e Avanzamenti)
20. **Testa sempre** su mobile dopo modifiche UI
21. **Testa sempre** su desktop dopo modifiche UI
22. **Testa sempre** su tablet dopo modifiche UI

---

## üìû API KEYS RICHIESTE

| Chiave | Posizione | Uso |
|--------|-----------|-----|
| `VITE_SUPABASE_URL` | `.env` | Database URL |
| `VITE_SUPABASE_ANON_KEY` | `.env` | Auth pubblica |
| `VITE_GOOGLE_GEO_API_KEY` | `.env` | Geocoding fallback |

---

## 9. Database migrations & Supabase

- Index columns that will be used in queries or relations.  Add `created_at` and `updated_at` timestamp columns to new tables with default values.
- When adding new functions or tables, write tests (if possible) and update RLS policies.

---

## MIGLIORAMENTI E ALTRO

## ‚ö†Ô∏è importante!
Migliorati avendo idee innovative o migliorative sul progetto, miglioramenti beckend e frontend etc etc

Crea sempre un copia di backups contenuti in `C:\Users\AdoniS4U\.gemini\antigravity\brain` dei piani, immagini e via dicendo (mantenendo i nomi delle cartelle e aggiungendo solo la data al nome della cartella) in `/brain_antigravity`

- Every change MUST include full responsiveness: Mobile, Tablet, Desktop.
- Follow existing design tokens, spacing, and typography.
- When implementing new sections: provide accessible markup, aria labels, keyboard nav.

---

Important:
Adhering to these rules will ensure that contributions to this project maintain quality, usability and brand consistency.

*Ultimo aggiornamento: 13 Dicembre 2024*